<!DOCTYPE html>
<html>
<head>
  <title>Number Memory Game</title>
  <style>
    .input-box {
      width: 50px;
      height: 50px;
      font-size: 36px;
      text-align: center;
      margin: 5px;
      display: inline-block;
    }
  </style>
</head>
<body>

  <h1>Number Memory Game</h1>
  
  <div id="numberDisplay"></div>
  <div id="userInputContainer" style="display:none;">
    <!-- Input boxes will be added here -->
  </div>
  
  <button onclick="checkAnswer()" style="display:none;" id="submitButton">Submit</button>
  
  <p>Level: <span id="level">1</span></p>
  <p>Score: <span id="score">0</span></p>
  
  <script>
    let level = 1;
    let score = 0;
    let originalNumber = "";
    let startTime = null;

    async function startGame() {
      originalNumber = generateUniqueNumber(level);
      for (let digit of originalNumber) {
        displayDigit(digit);
        await sleep(2000);
        clearDisplay();
      }
      displayInputBoxes(level);
      startTime = new Date().getTime();
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
    
    function generateUniqueNumber(length) {
      const digits = [...Array(10).keys()];
      let number = "";
      for (let i = 0; i < length; i++) {
        const randIndex = Math.floor(Math.random() * digits.length);
        number += digits.splice(randIndex, 1);
      }
      return number;
    }

    function displayDigit(digit) {
      document.getElementById("numberDisplay").innerText = digit;
    }
    
    function clearDisplay() {
      document.getElementById("numberDisplay").innerText = "";
    }
    
    function displayInputBoxes(length) {
      const container = document.getElementById("userInputContainer");
      for (let i = 0; i < length; i++) {
        const input = document.createElement("input");
        input.type = "text";
        input.className = "input-box";
        input.maxLength = 1;
        container.appendChild(input);
      }
      document.getElementById("submitButton").style.display = "block";
      document.getElementById("userInputContainer").style.display = "block";
    }
    
    function checkAnswer() {
      let elapsedTime = new Date().getTime() - startTime;
      let userNumber = "";
      document.querySelectorAll(".input-box").forEach(input => {
        userNumber += input.value;
      });
      
      // Partial credit based on correctness and timing
      let partialScore = 0;
      for (let i = 0; i < originalNumber.length; i++) {
        if (userNumber[i] === originalNumber[i]) {
          partialScore += 5;  // Correct position
        } else if (originalNumber.includes(userNumber[i])) {
          partialScore += 2;  // Correct number but wrong position
        }
      }
      score += partialScore - Math.floor(elapsedTime / 1000);
      if (userNumber === originalNumber) {
        level++;
      }
      document.getElementById("level").innerText = level;
      document.getElementById("score").innerText = score;
      document.getElementById("userInputContainer").innerHTML = "";
      document.getElementById("submitButton").style.display = "none";
      startGame();
    }
    
    startGame();
  </script>
  
</body>
</html>
